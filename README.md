# Домашнее задание к лекции «Select-запросы, выборки из одной таблицы» 


Задание выполнено на Python с использованием `sqlalchemy` без прямого использования SQL.

## Задание 1

### Тебуется выполнить несколько запросов для заполнения таблиц

Разработан класс для работы с базой данных musicapp podtgreesql, в котором реализован метод `load_albums_from_path()` позволяющая считать текстовые файлы с дискографией исполнителей и автоматически заполнить таблицы.

### пример заполнения таблицы

    vol_id = 1
    song_id = 1
    def load_song_vol(self, vol_id, song_id):
        song_vol_data = {'vol_id': vol_id,
                         'song_id': song_id
                         }
        connection = self.engine.connect()
        connection.execute(insert(self.songs_vol), song_vol_data)

эквивалентно:

    INSERT INTO songs_vol(vol_id, song_id) VALUES(NOW(), 1, 1);

## Задание 2

### Требуется выполнить запросы для получения данных из базы данных

1 название и год выхода альбомов, вышедших в 2018 году:

Реализован методом `get_album_by_year()` класса `MuscAppDb`

SQL:

    SELECT name, year FROM public."Albums"
        WHERE year = 2018

2 название и продолжительность самого длительного трека:

Реализован методом `get_long_playng_track()` класса `MuscAppDb`

SQL:

    SELECT name FROM public."Songs"
       ORDER BY playing_time DESC
    LIMIT 1;

3 название треков, продолжительность которых не менее 3,5 минуты:

Реализован методом `get_track_by_playng_time()` класса `MuscAppDb`

SQL:

    SELECT name FROM public."Songs"
       WHERE playing_time > 210


4 названия сборников, вышедших в период с 2018 по 2020 год включительно

Реализован методом `get_vols_by_years()` класса `MuscAppDb`

SQL:

    SELECT name FROM public."Vols"
        WHERE year BETWEEN 2018 AND 2020;

5 исполнители, чье имя состоит из 1 слова:

Реализован методом `get_one_word_name_aerists()` класса `MuscAppDb`

SQL:

    SELECT name FROM public."Artists"
        WHERE name NOT LIKE '% %';

6 название треков, которые содержат слово "мой"/"my"

Реализован методом `get_trek_by_word()` класса `MuscAppDb` , однако в загруженнйо бибилиотеке подходящих треков не нашлось, поэтому в примере испытан на других запросах.

SQL:

    SELECT name FROM public."Songs"
        WHERE name LIKE '%мой%' OR name LIKE '%my%';

# Домашнее задание к лекции «Группировки, выборки из нескольких таблиц»

Требуется написать SELECT-запросы, которые выведут информацию согласно инструкциям ниже:

1. количество исполнителей в каждом жанре;
2. количество треков, вошедших в альбомы 2019-2020 годов;
3. средняя продолжительность треков по каждому альбому;
4. все исполнители, которые не выпустили альбомы в 2020 году;
5. названия сборников, в которых присутствует конкретный исполнитель (выберите сами);
6. название альбомов, в которых присутствуют исполнители более 1 жанра;
7. наименование треков, которые не входят в сборники;
8. исполнителя(-ей), написавшего самый короткий по продолжительности трек (теоретически таких треков может быть несколько);
9. название альбомов, содержащих наименьшее количество треков.

SQL-скрипт содержится в файле [hw_5.sql](/hw_5.sql 'hw_5.sql')

Поскольку все запросы достаточно специфичные, нет необходимости реализовывать их ввиде методов класса. Поэтому все они реализованы отдельнйо функцей `select_request_by_hw5()` в файле [main.py](/main.py 'main.py')


## Схема базы данных musicapp

![схема базы данных](/img/musicapp.png)